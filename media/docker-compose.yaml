---
services:
  samba:
    # build: .
    image: ghcr.io/servercontainers/samba
    restart: unless-stopped
    network_mode: host 
    environment:
      # uncomment to enable fail fast (currently only fails fast if there are conflicts/errors during user/group creation)
      #FAIL_FAST: 1

      MODEL: 'TimeCapsule' 
      AVAHI_NAME: StorageServer
      SAMBA_CONF_LOG_LEVEL: 3 

      # uncomment to disable optional services
      #WSDD2_DISABLE: 1
      #AVAHI_DISABLE: 1
      #NETBIOS_DISABLE: 1

      ACCOUNT_homelab: ${ADMIN_PASS}  
      UID_homelab: ${ADMIN_USER_UID_VALUE}
      GROUPS_homelab: ${ADMIN_USER_GROUPS_VALUE} 
      SAMBA_VOLUME_CONFIG_adminonly: ${ADMIN_VOLUME_CONFIG_VALUE}

    volumes:
      - /etc/avahi/services/:/external/avahi
      - ${SAMBA_SHARE_1}:/shares/hdd
      - ${SAMBA_SHARE_2}:/shares/hdd1
      - ${SAMBA_SHARE_3}:/shares/hdd2
      
  jellyfin:
    image: jellyfin/jellyfin:2024123005  # Use the official Jellyfin image
    ports:
      - 8096:8096 
    container_name: jellyfin
    volumes:
      - ${JELLYFIN_CONFIG}:/config
      - ${JELLYFIN_CACHE}:/cache
      - ${JELLYFIN_FONTS}:/usr/local/share/fonts/custom
      - ${RADARR_DATA}:/movies
      - ${SONARR_DATA}:/shows
      - ${EXTERNAL_DRIVE}:/media/hdd2
    environment:
      - JELLYFIN_FFmpeg__probesize=${JELLYFIN_FFMEG_PROBSIZE}
      - JELLYFIN_FFmpeg__analyzeduration=${JELLYFIN_AALYZED_DURATION}
    restart: unless-stopped
  jellyseerr:
    image: fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    environment:
      - LOG_LEVEL=debug
      - TZ=Asia/Kolkata
      - PORT=5055 #optional
    ports:
      - 5055:5055
    volumes:
      - /path/to/appdata/config:/app/config
    restart: unless-stopped